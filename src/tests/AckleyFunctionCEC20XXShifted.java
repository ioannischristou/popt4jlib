package tests;

import popt4jlib.*;
import java.util.*;


/**
 * The Ackley test function for real function optimization for up to 1000 
 * dimensions shifted according to the specs in CEC2008. The function's args
 * are usually constrained in the interval [-32, +32]^n. See the 
 * <CODE>tests.AckleyFunction</CODE> class documentation for the definition of
 * the original function.
 * <p>Title: popt4jlib</p>
 * <p>Description: A Parallel Meta-Heuristic Optimization Library in Java</p>
 * <p>Copyright: Copyright (c) 2011</p>
 * <p>Company: </p>
 * @author Ioannis T. Christou
 * @version 1.0
 */
public class AckleyFunctionCEC20XXShifted implements FunctionIntf {
	private final static double _fShift = -140.0;
	
  /**
   * public default no-arg constructor
   */
  public AckleyFunctionCEC20XXShifted() {
  }

  /**
   * return the value of the Ackley function.
   * @param arg Object must be a <CODE>VectorIntf</CODE> object.
   * @param params Hashtable unused
   * @throws IllegalArgumentException if the arg is not of the expected type.
   * @return double
   */
  public double eval(Object arg, Hashtable params) throws IllegalArgumentException {
		VectorIntf x = null;
		try {
		 x = (VectorIntf) arg;
		}
    catch (ClassCastException e) {
			throw new IllegalArgumentException("AckleyFunctionCEC20XXShifted expects VectorIntf arguments only");
		}
    double res = 0.0;
    final double a = 20.0;
    final double b = 0.2;
    final double c = 2.0*Math.PI;
    final int n = x.getNumCoords();
    double t1 = 0.0;
    double t2 = 0.0;
    for (int i=0; i<n; i++) {
      final double xi = x.getCoord(i);
			final double zi = xi - _delta[i];
			t1 += zi*zi;
      t2 += Math.cos(c*zi);
    }
    res = -a*Math.exp(-b*Math.sqrt(t1/n)) -Math.exp(t2/n) + a + Math.E + _fShift;
    return res;
  }
	
	private final static double[] _delta = {27.00775711,-16.13168919,  6.41055501, 
		-0.84105188, 23.47793797, 15.72580998, -2.61194009,-28.88978141, 19.28442986, 
		-3.31779814,  6.92594089, 17.51622225, 25.30877824, 14.29243475,-19.42403133, 
		-5.65762722, 26.12818195, 25.01426639, -5.38378758, 23.61897185,-26.52652171, 
		-8.82791207, 18.78998984,-29.40832196,-21.66654708,-17.83408689,-18.07669544,  
		6.22754875,-13.66872450,-18.07114393,-29.08356438, 14.80714059, -3.29421406, 
		25.90887471, -2.04033950, -4.88103194, 20.77328507,  1.50914978,-17.84115854, 
		10.32824811, 20.28710670,-28.82162917, 10.87662968, -7.23113892, 19.90776106,  
		0.16877304, 12.56828356, -4.26645808,-11.72295799,-18.62077515,-18.39413062, 
		10.93339342,-11.83413595,  2.50043123,-20.94762143, 11.87390891, -7.29761997, 
		21.60069629, 21.21930784,  5.61377475, -0.20685302, 23.98615051, 19.29774964, 
		8.69462305, 19.07846045,  9.61365339, -9.48176290,-12.61644625, -9.52838584,  
		2.04474106, 13.62679302,-11.44259041, 20.30976270,  4.08434766, -7.77518660, 
		12.16439479,  2.79426911, -3.30718772, 11.67403443,  7.27860785, 17.68926481, 
		27.41060691,  1.35542094, 22.80853244,-19.62263152, 28.78481381,-13.71316448,
		-14.86023919, 22.54451399, 14.23835931,-21.80887546,-29.29459876, 23.63387799,
		-18.05171597,-12.07661927,  9.68655458,-12.93548462, -1.84654289,-26.11313262, 
		29.30009630,  4.96750089, -4.59022459,  0.93070513, -9.96291120, -4.02560423,
		-16.44300791,  4.78841239, 15.62190059,  1.78938700,  8.43158994,-17.45583573, 
		-7.21089778, 16.99971899, 10.85074508, -2.33429240,  4.06972275, 17.65263908,
		-26.44904439,  6.17214514,-26.98387178, -5.07750837,-11.70007938, 22.46203030,
		-29.09943008, 16.07702340, 28.25069636, 29.40495556, 17.33170153, -3.68048797, 
		-0.10132179,-17.16220010,  8.60953727,-10.79786535, 27.60591602, 13.59790600, 
		-5.28280751, 14.67394699,-13.92316496, -3.60454143, 26.00280649, 10.99993946,
		-17.24640814, 20.35429442,  7.72707600,-21.97363509,-17.57203622,  6.43193667,  
		7.79327093, -7.77139044,  4.50886674, -2.91451039,-27.36628048,-28.36889262,
		-11.23889712,-29.22824552, -6.96196269, 10.98695807,-24.42945230,-27.87970056,  
		6.74372888,  6.51242167,-29.05441092,-29.01870399,-18.59552466,  5.21510831,
		-26.54513461, -7.94591767,  7.88706988, 13.05806529, 11.56016368,-24.95525635, 
		-2.73869101, -3.49030219, -8.80497270,-20.78361825, 10.53867898, 11.95279966, 
		13.65054775, -1.29693714,  3.29051918,-22.73717322, -2.95476354, 12.95297689, 
		23.57049649,-13.61385179,-14.71384227, 21.93620866,-16.05897776, 18.29230465, 
		24.50385261,-16.08634091,-15.64124613,-27.01473096,-25.29695551,  8.44892459,
		-18.54680578, 20.63216993,-19.56598509,-19.75243118, 29.65772943, -3.61254858, 
		-9.59712307,-11.14696137, -8.09529678, -6.40562693,  5.49151222,-22.81520298,
		-27.71227219, -2.48412272, 22.19204102, 26.05419114,-14.13305003,-20.38197965, 
		22.37131542,-15.72718154,  8.74987500, 28.01324525,  9.89587272, 22.22286155,
		-29.40436171,-21.77940650, 19.12534959, -4.19003706, 23.41930343, 14.09449271, 
		11.23941550, -9.23328194,-20.03791567,-20.66324542,-18.53302131, -4.65290845, 
		21.35854244, -0.58500078, 18.95608614, -2.35381012, -2.55873719, -2.95866710, 
		-5.26685634, 24.09658949,-29.66496365,-12.15565926,-27.05025065, 11.59082720,  
		9.00638459, 28.97926692,  3.16039461, -5.99558905,-18.07268881,  7.51206137, 
		14.00176811, -7.44687110,-29.40741223, -4.80853162, 15.22017755, 17.63230648, 
		25.19743240, 20.68329011, -7.93482705,  7.24807991, 13.87663587,-18.36640920, 
		24.28874005,  4.15234498,  7.90739575,-15.93522268,  2.92692753, 25.89500115, 
		-9.88815419,  9.33186330, -6.48574759,  7.63888729, 11.94480826, -6.16896277, 
		-5.18226628,  9.31277678, 20.25510593, -7.70351807, -4.48481049,  5.67980229, 
		3.94431433, 12.99254384,  0.67868689, 16.58407272, -0.63927145,-18.84573293, 
		12.03812431, 28.96252811, 18.39826496, 12.21405930, -0.90217684,-23.12323073,  
		9.89133403, -8.07756650,-21.59733261,  4.00636802, 19.38049886, 10.43691793, 
		29.96683830, 27.69818443,-26.46827007, -8.38132974,  2.91076882,-14.29382581, 
		5.84069088,-27.04332020,  4.26344966, 12.05143399, 27.73729552, 15.03109392, 
		14.39958272, -4.08759686,  8.05595738, 18.18158041,-24.96713958, 26.72776727,
		24.95654759,  6.11924542,-14.78636528, 22.40704833,  0.80404260, 13.95903895, 
		-4.66640483, 27.68219993,-25.67644569,  3.20447808,-12.48096473, 21.47781079, 
		-9.85469168, 10.81223102,-26.79333472, -8.60066776, -0.10172424, -3.93356771, 
		3.74750503,  6.99726781,-23.19960115, 23.89510444, 15.27308251, 17.46739174, 
		18.89712408, 10.20023189,-17.94741526,-13.61471031,  7.57407832,  2.21110169,
		-26.42975694,-24.66229443,-13.72150954, -5.45566105, -1.55751298, 24.53936094, 
		5.77482829,-10.26268187, -1.30833446,  5.83024676,-20.31307471, 19.76845505, 
		27.36734438,  5.73287971,-28.27510721, 18.72706913,  6.60681457, 
		12.08955605,-24.46822784, -4.50665152, -7.46540049,-20.03075514, 19.98908757, 
		20.31838228, -2.90315825, 27.39608290,-21.17080581, 22.19597579, 16.16618401, 
		-3.35030306,  7.23720726, 27.10135685,  8.40057933,-15.16034226, -8.83788031,
		-18.72837117, -0.56133851, -5.44354025, -2.18846497,  6.65661299,-25.72989205,
		-11.14318265,  6.50301931,-19.49878908,  7.26164601,-15.24240397,  5.24149291,  
		0.36320723, -2.11326457,  2.48513582, 26.53959417, -9.49445460, -5.89173945,
		-11.53872387, -5.30592244,-12.84364606, -6.35234333,  0.18086913, 13.31879078,
		-11.62748727,-23.27017729, -3.40260240, -1.99424687,-29.11986748,  9.84311196, 
		13.44370252,-13.10198382,-14.29087931, 12.50828429, 17.03154137, 29.16946839, 
		-1.59943768, 24.16913006, -2.93647433, 18.27100852, 19.73186858,-20.02379300, 
		-6.36563968,  1.24544906, 13.08743834,  4.15137113, -2.35162960, -3.28157680,
		-24.73532363, -3.39100709, -8.02200924,-11.84797089, 21.11068184, 15.56876327, 
		26.98555708,  3.47631054,-29.14601904,  5.77062507, 18.97234255, 28.62554129,
		-16.68551523, 12.22102004,  1.32365492, 25.97382340, 12.80126661,-16.31766582, 
		-3.02147372,-19.66801827, 28.12920859, -8.65703373,-27.05719031, 15.32031431, 
		23.68876581,-12.83102097,-14.92796722, 25.96417148,-22.14105185, 26.44917254, 
		12.11119041, 20.86058809,-17.44370156, -2.69449855,-25.13557649, 21.06734406,  
		3.72292059,-10.84222222, -7.50604431, 22.06774187, -7.66942559,-25.57859666,
		-18.00972026,-27.03040322,  4.00258675,-22.68451501,  1.32670581,-22.97639086, 
		16.19510866, -7.49665220, 19.40323222,-27.20183127,  5.87479570, 26.94902367,
		-12.67214083, 23.32995662,-23.90487131,-26.08112960,-15.94201600, 25.98590511,
		-26.21232624,-14.14694018, 29.97190046,-17.28072225, -0.09541209,-12.57070229, 
		10.36526466, 27.47946719, 15.99309207,  9.96742426,-22.14331067,-24.27521901,
		-29.10813975,-12.70839926, 19.00387281, 29.12901059,-28.95823842, 19.16357594,  
		7.26832235,  3.61332246,-15.35810796, 19.32045531,-14.20728432, 15.21807206,  
		9.57868793,-17.15622865,  6.12701450,  6.29622660,  9.57009289,-18.99818205,  
		8.19281432,-19.78145339,  2.37606635,  7.40365095, 11.15339839, 10.64075716, 
		22.60980145,-29.22656999,-11.37586644, 16.74475485,-11.56223490, 25.60069864, 
		10.72319255,-25.54071043,-25.75984852,-29.28417200,-16.37077710,  0.97511982, 
		-2.50774708, 12.19220030,  4.94903250,  0.55236011,-25.54262345,-18.40582118, 
		-7.22375200,-13.41391677, 16.25291017,-11.16420060,  8.29159315, 29.19401185,  
		0.17254822, 26.86220261, 19.68155051, 25.05343219,-23.21521025, 18.72755436, 
		24.49575379,-20.61743284,-22.67287400, 15.75998819, 13.30801707,  9.09838900, 
		15.24135995,  9.78972047, 23.00961011,-13.67055382, -4.83403707,-17.22038047,
		-27.86400198,-25.13017775, 21.03400699, -9.58779316, -2.03070131, 24.82579438,
		-16.28539765, 21.72269401,  9.39711214, 23.47096815, -0.71138891, 29.55873880, 
		-7.60044357,  1.88269907,-19.12102027,  0.11666011, -4.66831036,  9.62564397, 
		10.41918067, 27.43981097,-18.48805526,-23.32701371,  3.90323225, 28.14997635,
		-28.57536775, 22.21294932,-28.38740443,  1.17172130,-18.46251476, 12.94134281,
		-14.95963312, 26.03188895,-21.76864125,  1.29734035, 23.71210143, 26.54323526, 
		-9.89499728, -3.75817058, -1.73064545,-21.04137987,-21.84813635,  1.94989381, 
		13.54735857, -6.07781692, -8.49488904,-12.88323527, 22.11811464,  7.58476048,
		-15.52966149, 28.68489918,  8.43004680,-16.20908115, 10.88010930,  9.94940451,
		-21.91692157,-28.65040240,-14.26803304,-23.00909042,-25.84090573, 21.17582986,
		-19.18015965,-28.05488614, 14.03557542,  2.19100936,-13.43822019, -7.89251081,
		-29.22682167, 23.35236507, 21.96123612,-14.74518392,  4.16883580,-20.44411092,  
		5.66186497,-10.13399513,  9.51675924, 21.81805309,  4.05739883, 28.82887647, 
		17.50989614,-20.84438268, 19.98163398,-18.48820413,  8.33919407, 10.14000476, 
		16.32526800, -7.21093502, -3.50487088, -1.01640038,  6.48633939,-19.44026152,
		-29.87846634, 17.41344013,  0.81651010,-17.20623741,-23.79301224,-20.55980005, 
		-5.54910119, -5.53457868,-26.83843874, 26.50890899,-21.00169895, -6.93755723,
		-11.33648645,-19.88793342, 23.79888877,-10.63653411, 14.03977901, -5.34574905, 
		-6.01236926,  0.33133244,-19.84164845,  1.48472941,  8.47215980,-29.02815096, 
		20.21109335, 18.20773127, 11.86708981, -2.28673310,-25.04324293, 19.24302052,
		-18.41879893, -3.27871631,-29.22253023,-11.47549220, 22.52105898, 20.11556392,
		-10.01429595, 22.84231991, -1.21879166,  3.64900367,  6.95451933,  9.71394090,  
		6.99799410, 11.10840001,  0.60918162, 12.83765067,  0.91247397,  6.35194765, 
		28.00215778, 19.32704411,-10.93495923,  5.26180632,-22.18789971,-14.73874458, 
		18.18185390, 10.07075362,-29.18241883,  3.69476218, -2.72634372, 24.29695320,
		-13.07046893,-26.09793877, -1.40448688, 29.02271509, 25.34097487,  3.67177529,  
		9.13948162, 16.36077583,-23.62945239,-29.93559807,  2.50582737,-29.58853250, 
		-2.91973967,-18.26027690, 17.22858773,  7.11375745,-29.06874257, 23.45123790, 
		15.70219148, 24.42210245, 15.51411594, -7.15620374,-10.13335285,  0.24470662,  
		3.87411564, 16.03184142, 16.79206677, -0.95412691, 18.13279349, -1.73927078,
		-17.83446626,  4.77689357,  9.99001557, 10.60591729, 26.55067460, 16.20891201, 
		14.24425893, 21.97573643, 29.45689922,  0.23565592,  7.74513306, 17.55661924, 
		-3.08104769,  1.46142645,-19.71160672,-22.16005490,-16.87313256,-23.67116984,
		-21.51444886, -2.58190193, 17.28798273,-13.13616143,-16.51279616, 24.53248397,
		-29.56026929,  5.32436007,  2.52707222,  9.21143886,-11.19390141,-16.13047051,
		-5.03617013,-12.07207273, 10.34618345, 26.29544879, -9.41113838,  3.77775432,
		-22.86668654,-19.85872435,-13.26627495,  3.40887946, -0.86465035, 27.13339359,
		-16.08474942, -1.28049640,  1.59134404, 17.56324762,-18.41954088, 24.57602674,
		25.33178356,-29.20401807, 16.05297801, 26.84055831, 18.79833148, 25.42978763,
		-18.06016449, 10.45629853, 25.62618516, -9.37100444,  5.66957627,  6.92922020,
		-29.79755551, 28.92075410, 23.97078551, 11.56544086, -3.62077941, 12.06137479, 
		6.58289933,-12.00686031, 21.36223162,-23.27566979,-12.50637535,-24.15319635, 
		-6.15312182,-10.00124086, 26.65408283, 20.31332718,-14.49435582,-27.42611249,
		-29.64691261,  4.46507804, 14.63411714, 18.40984703,  8.25423866,-14.92372119,
		-21.34077291,  9.09306795, 26.76521586, 18.95320776, 25.81482392,-11.40351843,
		-13.87097334,  2.18706210,-20.20330225,-17.34071867,-16.99127458,  9.10738977,
		-26.83342884,-16.24258318, 10.04592771,-11.34397938,-11.60202827, 13.24079305, 
		27.26439060,-22.13169642,-25.90339146,-22.48636388,-20.03079509, 24.68504788,
		-21.82438395,  7.01972525,-13.86110122,-16.76015804, 12.77406132,  2.93978654,
		26.48090544,-10.20811332, 12.26917811, 26.60552763,  4.89566025, 22.80925109, 
		14.97669867, -7.22295946, 13.53367676,-20.23210780, 27.37227675,-18.22627017, 
		16.57155035,  6.79774294,-20.26318614,-28.13675679,-12.68227108, 28.26385675, 
		27.02996051,-16.31713153, 27.51156508, 10.79149556,-26.70184750,  5.99047905, 
		-6.41124040,-17.07802888,-19.05602252,-25.39475855,-29.55457824, 17.32697978,
		-28.93274219, 22.67648793, -8.84749390, 13.32838607, 28.10705036,-20.65992099,
		-20.22266748,-11.19615790,-28.23710711, -8.54249298,-28.36857610, 17.62002112,
		29.95384527,-23.38568853,  7.35606952,-22.04568929,-11.39821266,-21.91273873,
		-16.60042124, -6.20719270,-21.89139031,-15.53647864, 25.65096899, -6.53394756, 
		0.67576641,-24.42623303,-28.69806514,-20.42791040, 20.67095663, 22.74920895,
		-18.78062845, 29.47829514, 12.72179047, 22.28187700, -1.22212891, -0.23970441,
		-12.74808815,-26.34351294,-14.25193775,-18.82433898, 25.02538721,-22.60327834,
		-29.19327701, -7.81855689, 11.91846650, 23.36083279,  5.62623115,-20.59854620,
		-10.99863488,-15.99627085,-29.49467618, -6.18577249,  8.99208784,-24.89996363, 
		16.12857020, 28.18210230, 12.88783391, 16.91771052,-15.74609508,-18.25615417,
		-14.20716509, 12.82710388, 28.65598437,  8.22731645,  2.75544931, 20.88343347, 
		18.12585951, 10.09838460, 10.25895804, 19.23862094, 28.22834248, -0.78450027, 
		19.04811213,  8.49427007,-11.61903843,  9.65592793, -8.51897320, 26.29196581, 
		-0.73998151,-24.54057854, 10.43004701,  0.89281914,-16.70523922, 13.50056226,
		-25.90520334, 27.84745610,-17.54060470,-20.33290647,  8.29328296,-29.98630963, 
		-9.86202340,-13.49401071,-27.32834878,-24.36621014, -5.40015601, 19.01353917, 
		22.23102431,-28.64669277, 13.63061902, 20.88056688, 13.71601146, 27.30591800, 
		9.38106664, 14.53830801, -9.30203917, 23.04131698, -9.16535481,-26.43139917, 
		13.10487546, 27.49285757 };
	
}
